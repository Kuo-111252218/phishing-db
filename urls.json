import requests
import json

def fetch_openphish():
    url = "https://openphish.com/feed.txt"
    r = requests.get(url)
    return r.text.splitlines() if r.status_code == 200 else []

def fetch_phishtank():
    url = "http://data.phishtank.com/data/online-valid.json"
    r = requests.get(url)
    if r.status_code == 200:
        data = r.json()
        return [item["url"] for item in data if "url" in item]
    return []

def fetch_urlhaus():
    url = "https://urlhaus.abuse.ch/downloads/text/"
    r = requests.get(url)
    if r.status_code == 200:
        return [line for line in r.text.splitlines() if not line.startswith("#")]
    return []

def main():
    all_urls = set()

    print("ğŸ”„ æŠ“å– OpenPhish...")
    all_urls.update(fetch_openphish())

    print("ğŸ”„ æŠ“å– PhishTank...")
    all_urls.update(fetch_phishtank())

    print("ğŸ”„ æŠ“å– URLhaus...")
    all_urls.update(fetch_urlhaus())

    # è¼¸å‡º JSON
    with open("urls.json", "w") as f:
        json.dump(sorted(all_urls), f, indent=2)

    print(f"âœ… å·²æ›´æ–° urls.jsonï¼Œå…± {len(all_urls)} æ¢ç¶²å€")

if __name__ == "__main__":
    main()
